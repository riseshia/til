# Ruby에서 형태소 분석하기
## 준비물
일단 한글을 분석한다고 가정하고, mecab 한글 버전과 사전을 준비. 공개되어 있는 은전한닢 프로젝트를 이용합니다. 그리고 ruby bind gem인 `natto`를 인스톨. 설치 방법은 각 저장소를 참고해 주세요.

* [mecab-ko](https://bitbucket.org/eunjeon/mecab-ko)
* [mecab-ko-dic](https://bitbucket.org/eunjeon/mecab-ko-dic)
* [natto](https://github.com/buruzaemon/natto)

## 사용하기
`mecab`이 정상적으로 설치되었다면, natto가 PATH를 통해서 이를 접근할 수 있게 됩니다.

```ruby
nm.parse('오늘 밤도 그렇게 울다 잠이 든다.')
```

와 같은 식으로 사용할 수 있습니다. 블럭을 넘겨서 좀 더 자세한 정보도 뽑아올 수 있으며, 추가적인 옵션에 대해서는 `natto`의 설명을 참고해주세요.

## 결과
데이터는 모 슬랙 아카이브 데이터를 사용해서 명사, 동사만 추출해봤습니다.

### space로 토큰을 나누었을 때
```
has, 9587
joined, 8868
the, 10642
channel, 9853
uploaded, 2076
a, 3296
file:, 2201
네, 1684
ㅎㅎ, 2926
것, 2526
전, 2784
ㅋㅋㅋㅋ, 2156
이, 1328
다, 2304
상위 랭커들...
```

### ko-dic를 사용했을 때
리팩토링, 37
프로그래머, 92
애플, 1036
문제, 1408
모닝, 1516
서버, 1051

## 결론
여기에는 데이터가 없는데, 한글 사전이 있고 없고의 키워드 추출 성능 차이가 많이 났습니다. 사전이 없는 경우, 고유명사나 자신이 인식하지 못하는 동사들을 한없이 쪼개는 문제가 있었고, 한국어 사전을 쓰더라도 아무래도 고유명사가 깔끔하게 처리되지 않는 애로사항이 많습니다. 제대로 작업을 하려면 데이터 정제 작업(봇 대사나 스크립트 키워드 등을 제거)과 사용자 사전을 좀 충실하게, 이왕이면 자동화할 수 있게끔 만들어야하지 않을까... ㅇ<-<

## Troubleshooting
### userdic 추가하기(OSX)
mecab-ko, mecab-ko-dic을 사용하는 경우에 발생할 수 있는 문제입니다. `add-userdic.sh`를 실행해서 사용자 사전 정보를 추가해달라고 하는데, 기본 설정으로는 이 스크립트가 정상적으로 실행되지 않습니다.

아래의 코드에는 위쪽이 원래 코드, 후자가 변경한 코드입니다.

```bash
readonly PROG_DIR=$(readlink -m $(dirname $0))

readonly PROG_DIR=current_dic_path
```

사전 정보가 저장되어 있는 폴더를 지정. `readlink`의 `-m` 옵션이 사용 불가. 사용법을 모르시면 저처럼 그냥 경로지정을 강제로 하시면 됩니다.

```bash
readonly DIC_PATH=$PROG_DIR/..

readonly DIC_PATH=$PROG_DIR/
```

기본 사전의 경로가 사전 폴더의 `root`로 되어 있으므로 변경해줍니다.

이걸로 정상적으로 동작할...거라고 믿어봅시다!